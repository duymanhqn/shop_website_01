<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Thanh to√°n ƒë∆°n h√†ng</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/checkout.css') }}">
  </head>

  <body>
    <!-- Thanh ƒëi·ªÅu h∆∞·ªõng -->
    <nav class="navbar">
      <div class="logo">MHTHM</div>

      <div class="menu">
        <a href="{{ url_for('home_bp.home') }}">Trang ch·ªß</a>
        <a href="{{ url_for('home_bp.home') }}">S·∫£n ph·∫©m</a>
        <a href="#">Khuy·∫øn m√£i</a>
        <a href="#">Li√™n h·ªá</a>
      </div>

      <div class="right">
        <a href="{{ url_for('cart_bp.cart') }}">Gi·ªè h√†ng</a>
        {% if session.get('username') %}
        <span class="user">üë§ {{ session['username'] }}</span>
        <a href="{{ url_for('auth_bp.logout') }}" class="logout-btn">ƒêƒÉng xu·∫•t</a>
        {% endif %}
      </div>
    </nav>

    <!-- Khu v·ª±c thanh to√°n -->
    <section class="checkout-section">
      <div class="checkout-container">
        <h2>Thanh to√°n ƒë∆°n h√†ng</h2>

        <table>
          <tr>
            <th>T√™n s·∫£n ph·∫©m</th>
            <th>S·ªë l∆∞·ª£ng</th>
            <th>Gi√°</th>
            <th>Th√†nh ti·ªÅn</th>
          </tr>
          {% for item in cart_items %}
          <tr>
            <td>{{ item.product.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ "{:,.0f}".format(item.product.price) }} VND</td>
            <td>{{ "{:,.0f}".format(item.total_price) }} VND</td>
          </tr>
          {% endfor %}
        </table>

        <h3 class="total">T·ªïng c·ªông: {{ "{:,.0f}".format(total) }} VND</h3>

        <form id="paymentForm" method="POST">
          <h3>Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n:</h3>

          <label>
            <input type="radio" name="payment_method" value="COD" checked>
            Thanh to√°n khi nh·∫≠n h√†ng (COD)
          </label><br>

          <label>
            <input type="radio" name="payment_method" value="MOMO">
            Thanh to√°n qua MoMo
          </label><br><br>

          <button type="submit" class="confirm-btn">X√°c nh·∫≠n ƒë·∫∑t h√†ng</button>
        </form>
      </div>
    </section>

    <script>
      document.getElementById("paymentForm").addEventListener("submit", function (e) {
        e.preventDefault();
        const method = document.querySelector('input[name="payment_method"]:checked').value;

        if (method === "MOMO") {
          window.location.href = "{{ url_for('order_bp.momo_payment') }}";
        } else {
          this.action = "{{ url_for('order_bp.confirm_order') }}";
          this.submit();
        }
      });
    </script>
  </body>
</html>
