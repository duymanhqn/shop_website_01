<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Gi·ªè h√†ng</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/cart.css') }}"
    />
  </head>

  <body>
    <!--  THANH NAVBAR -->
    <div class="navbar">
      <div class="logo">MHTHM</div>
      <div class="menu">
        <a href="/">Trang ch·ªß</a>
        <a href="{{ url_for('product_info_bp.product_info') }}">S·∫£n ph·∫©m</a>
        <a href="#">Khuy·∫øn m√£i</a>
        <a href="{{ url_for('contact_bp.contact') }}">Li√™n h·ªá</a>
      </div>
      <div class="right">
        <a href="{{ url_for('auth_bp.logout') }}" class="logout-btn">
          ƒêƒÉng xu·∫•t
        </a>
      </div>
    </div>

    <!--  KHU V·ª∞C GI·ªé H√ÄNG -->
    <section class="cart-section">
      <div class="cart-container">
        <h2>Gi·ªè h√†ng c·ªßa b·∫°n</h2>

        {% if cart_items %}
        <table>
          <thead>
            <tr>
              <th>H√¨nh ·∫£nh</th>
              <th>T√™n s·∫£n ph·∫©m</th>
              <th>S·ªë l∆∞·ª£ng</th>
              <th>Gi√°</th>
              <th>Th√†nh ti·ªÅn</th>
              <th>H√†nh ƒë·ªông</th>
            </tr>
          </thead>
          <tbody>
            {% for item in cart_items %}
            <tr>
              <td>
                <!--  ƒê√∫ng ƒë∆∞·ªùng d·∫´n: Flask s·∫Ω l·∫•y static/images/IP_16.png -->
                <img
                  src="{{ url_for('static', filename=item.product.image_url) }}"
                  alt="{{ item.product.name }}"
                  onerror="this.onerror=null; this.src='{{ url_for('static', filename='images/no-image.png') }}';"
                />
              </td>
              <td>{{ item.product.name }}</td>
              <td>
                <div class="quantity-control">
                  <!-- üîπ N√∫t gi·∫£m -->
                  <form
                    action="{{ url_for('cart_bp.update_quantity', product_id=item.product.id, action='decrease') }}"
                    method="POST"
                    style="display: inline"
                  >
                    <button type="submit" class="qty-btn">‚àí</button>
                  </form>

                  {{ item.quantity }}

                  <!--  N√∫t tƒÉng -->
                  <form
                    action="{{ url_for('cart_bp.update_quantity', product_id=item.product.id, action='increase') }}"
                    method="POST"
                    style="display: inline"
                  >
                    <button type="submit" class="qty-btn">+</button>
                  </form>
                </div>
              </td>

              <td>{{ "{:,.0f}".format(item.product.price) }} VND</td>
              <td>{{ "{:,.0f}".format(item.total_price) }} VND</td>

              <td>
                <form
                  action="{{ url_for('cart_bp.delete_item', product_id=item.product.id) }}"
                  method="POST"
                >
                  <button type="submit" class="delete-btn">X√≥a</button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <!--  T·ªïng ti·ªÅn -->
        <div class="total">T·ªïng c·ªông: {{ "{:,.0f}".format(total) }} VND</div>

        <!--  N√∫t h√†nh ƒë·ªông -->
        <div class="action">
          <a
            href="{{ url_for('product_info_bp.product_info') }}"
            class="back-btn"
            >Ti·∫øp t·ª•c mua h√†ng</a
          >
          <a href="{{ url_for('order_bp.checkout') }}" class="btn-primary"
            >Thanh to√°n</a
          >
        </div>

        {% else %}
        <p class="empty-cart">Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng!</p>
        <a
          href="{{ url_for('product_info_bp.product_info') }}"
          class="back-btn"
          >Xem s·∫£n ph·∫©m</a
        >
        {% endif %}
      </div>
    </section>
  </body>
</html>
